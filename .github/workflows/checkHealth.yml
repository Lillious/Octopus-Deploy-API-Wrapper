name: Check Connection Health 🐙

on:
  workflow_dispatch

jobs:
  check-connection-health:
    runs-on: ubuntu-latest
    steps:
      - name: Install Octopus CLI 🐙
        uses: OctopusDeploy/install-octopus-cli-action@v3
        with:
          version: '*'

      - name: List Deployment Targets
        id: deployment-targets
        env:
          OCTOPUS_URL: ${{ secrets.OCTOPUS_URL }}
          OCTOPUS_API_KEY: ${{ secrets.OCTOPUS_API_KEY }}
          OCTOPUS_SPACE: 'Default'
        run: >
          octopus deployment-target list --output-format json

      # - name: Process Deployment Targets
      #   run: |
      #     targets_json="${{ steps.deployment-targets.outputs.targets }}"
      #     echo "$targets_json" | jq -r '.[] | .Name, .Id, .EnvironmentIds'
